<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter [
<!-- Some useful entities borrowed from HTML -->
<!ENTITY ndash  "&#x2013;">
<!ENTITY mdash  "&#x2014;">
<!ENTITY hellip "&#x2026;">
<!ENTITY plusmn "&#xB1;">

<!-- Useful for describing APIs -->
<!ENTITY GET    '<command xmlns="http://docbook.org/ns/docbook">GET</command>'>
<!ENTITY PUT    '<command xmlns="http://docbook.org/ns/docbook">PUT</command>'>
<!ENTITY POST   '<command xmlns="http://docbook.org/ns/docbook">POST</command>'>
<!ENTITY DELETE '<command xmlns="http://docbook.org/ns/docbook">DELETE</command>'>

<!ENTITY CHECK  '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
<imageobject>
<imagedata fileref="figures/Check_mark_23x20_02.svg"
format="SVG" scale="60"/>
</imageobject>
</inlinemediaobject>'>

<!ENTITY ARROW  '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
<imageobject>
<imagedata fileref="figures/Arrow_east.svg"
format="SVG" scale="60"/>
</imageobject>
</inlinemediaobject>'>
]>
<chapter xmlns="http://docbook.org/ns/docbook"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xi="http://www.w3.org/2001/XInclude" version="5.0"
    xml:id="ch_wadl">
    <?dbhtml stop-chunking?>
    <title>Use WADLs to Generate API Reference Outputs</title>
    <para>You can use Web Application Description Language (WADL)
        files to describe HTTP-based Web applications and generate API
        reference outputs.</para>


    <para>This chapter shows you how to: <itemizedlist>
            <listitem>
                <para>Create WADLs to describe HTTP-based Web
                    applications.</para>
            </listitem>
            <listitem>
                <para>Generate API reference outputs from WADL files.
                </para>
            </listitem>
        </itemizedlist></para>

    <para>Rackspace developers and writers also use WADL files to
        configure Repose. This chapter does not cover this
        topic.</para>

    <para>For complete information about the WADL language, see <link
            xlink:href="http://www.w3.org/Submission/wadl/">Web
            Application Description Language</link>. The information
        in this chapter comes from that document. </para>


    <section xml:id="create_wadl">
        <title>Create WADL Files</title>

        <para>The following example shows you how to tag WADL elements
            and attributes: <example>
                <title>Example WADL File</title>
                <programlistingco>
                    <areaspec>
                        <area xml:id="test.wadl.application"
                            units="linecolumn" coords="6 1"/>
                        <area xml:id="test.wadl.grammars"
                            units="linecolumn" coords="12 1"/>
                        <area xml:id="test.wadl.resources"
                            units="linecolumn" coords="16 1"/>
                        <area xml:id="test.wadl.doc"
                            units="linecolumn" coords="18 1"/>
                        <area xml:id="test.wadl.resource"
                            units="linecolumn" coords="20 1"/>
                        <area xml:id="test.wadl.param"
                            units="linecolumn" coords="23 1"/>
                        <area xml:id="test.wadl.method_ref"
                            units="linecolumn" coords="32 1"/>
                        <area xml:id="test.wadl.method_def"
                            units="linecolumn" coords="46 1"/>
                        <area xml:id="test.wadl.request"
                            units="linecolumn" coords="57 1"/>
                        <area xml:id="test.wadl.representation"
                            units="linecolumn" coords="59 1"/>
                        <area xml:id="test.wadl.code"
                            units="linecolumn" coords="66 1"/>
                        <area xml:id="test.wadl.response"
                            units="linecolumn" coords="81 1"/>
                    </areaspec>
                    <programlisting language="xml"><?db-font-size 55%?><xi:include href="xsd/test.wadl" parse="text"/></programlisting>
                </programlistingco>
            </example></para>
        <para>The main elements and attributes in a WADL are:</para>

        <calloutlist>

            <callout arearefs="test.wadl.application">
                <para><emphasis role="bold">application</emphasis>
                </para>

                <para>The root of a WADL description. Must contain the
                        <literal>xmlns</literal> attribute, which
                    defines the XML namespace name. For WADLs, this is
                    always
                        <code>http://wadl.dev.java.net/2009/02</code>.
                    See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-70002.2"
                        >Application</link>.</para>
            </callout>



            <callout arearefs="test.wadl.doc">
                <para><emphasis role="bold">doc</emphasis>
                </para>

                <para>Documents its parent WADL element. See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-80002.3"
                        >Documentation</link>.</para>
            </callout>

            <callout arearefs="test.wadl.grammars">
                <para><emphasis role="bold">grammars</emphasis></para>


                <para>Includes definitions of the format of data
                    exchanged during execution of the protocol
                    described by the WADL document. See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-90002.4"
                        >Grammars</link>.</para>
            </callout>
            <callout arearefs="test.wadl.resources">
                <para><emphasis role="bold"
                    >resources</emphasis></para>

                <para>A container for the resources provided by the
                    application. Must contain the <emphasis
                        role="bold">base</emphasis> attribute, which
                    provides the base URI for each child resource ID.
                    See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-110002.5"
                        >Resources</link>.</para>
            </callout>



            <callout arearefs="test.wadl.resource">
                <para><emphasis role="bold">resource</emphasis></para>
                <para>Describes a resource provided by the
                    application. Each resource is identified by a URI
                    that follows a common pattern. Must contain the
                        <emphasis role="bold">id</emphasis> attribute,
                    which identifies the resource element. Can contain
                    the <emphasis role="bold">path</emphasis>
                    attribute, which provides a relative URI template
                    for the ID of the resource. See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-120002.6"
                        >Resource</link>.</para>


            </callout>

            <callout arearefs="test.wadl.param">
                <para><emphasis role="bold">param</emphasis></para>
                <para>A parameterized component of its parent element.
                    See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-250002.12"
                        >Parameter</link>.</para>
            </callout>
            <callout arearefs="test.wadl.method_ref">
                <para><emphasis role="bold">method</emphasis>
                    reference</para>
                <para>Provides the <emphasis role="bold"
                        >href</emphasis> attribute, which
                    cross-references a <emphasis role="bold"
                        >method</emphasis> definition element. See
                        <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-160002.8.1"
                        >Method Reference</link>. </para>
            </callout>
            <callout arearefs="test.wadl.method_def">
                <para><emphasis role="bold">method</emphasis>
                    definition</para>
                <para>A child of a <emphasis role="bold"
                        >resource</emphasis> or <emphasis role="bold"
                        >application</emphasis> element. The <emphasis
                        role="bold">name</emphasis> attribute
                    indicates the HTTP method. The <emphasis
                        role="bold">id</emphasis> attribute matches
                    the value of the <emphasis role="bold"
                        >href</emphasis> attribute on the
                    corresponding method reference. See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-170002.8.2"
                        >Method Definition</link>.</para>
            </callout>
            <callout arearefs="test.wadl.request">
                <para><emphasis role="bold">request</emphasis></para>
                <para>Describes a request to the method. See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-180002.9"
                        >Request</link>.</para>
            </callout>

            <callout arearefs="test.wadl.representation">
                <para><emphasis role="bold"
                    >representation</emphasis></para>
                <para>Provides a representation of a resource's state.
                    See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-210002.11"
                        >Representation</link>.</para>
            </callout>

            <callout arearefs="test.wadl.code">
                <para><emphasis role="bold">code</emphasis></para>
                <para>An included JSON- or XML-formatted code sample.
                </para>
            </callout>

            <callout arearefs="test.wadl.response">
                <para><emphasis role="bold">response</emphasis></para>
                <para>Describes the output from performing an HTTP
                    method on a resource. Can contain the <emphasis
                        role="bold">status</emphasis> attribute, which
                    lists the HTTP status codes associated with a
                    particular response. See <link
                        xlink:href="http://www.w3.org/Submission/wadl/#x3-200002.10"
                        >Response</link>.</para>
            </callout>
        </calloutlist>


    </section>
    <?hard-pagebreak?>
    <section xml:id="include_wadl">
        <title>Generate API Reference Information</title>
        <para>The clouddocs Maven plugin enables you to include
            entire, or specified elements in, WADL files within your
            DocBook XML files. When you generate artifacts for your
            book, the WADL file elements are transformed into various
            API reference outputs.</para>


        <!-- <itemizedlist>
            <listitem>
                <para><code>role="api-reference"</code>. If you
                    include this attribute on a chapter or section
                    element, a rollup table or "cheatsheet" appears in
                    the chapter or section. The rollup table lists all
                    methods that are documented in the chapter or
                    section and any of its children. </para>

                <para>The chapter or section that contains the WADL
                    markup does not need the
                        <code>role="api-reference"</code> attribute
                    because that chapter or section automatically gets
                    a roll-up table.</para>
            </listitem>
            <listitem>
                <para><emphasis role="bold">WADL markup in a chapter
                        or section</emphasis>. The <code>href</code>
                    attribute on the <code>resource</code> element
                    specifies the name of the WADL file and the ID of
                    the resource. </para>
                <para>The <code>href</code> attribute on a
                        <code>method</code> element specifies the ID
                    of the method.</para>
            </listitem>
        </itemizedlist>


        <para>To create the following types of output, point to the
            following elements in external WADL files from within your
            XML files:</para>

        <table rules="all">
            <caption>API Reference Outputs</caption>

            <thead>
                <tr>
                    <th>Output</th>
                    <th>Description</th>
                    <th>Scope</th>
                    <th>Point to</th>
                    <th>From where?</th>

                    <th>See</th>
                </tr>
            </thead>
            <tbody>

                <tr>
                    <th>Roll-up table</th>
                    <td>A table that shows method, URI, and short
                        description for methods.</td>
                    <td>All or specified methods for all or specified
                        resources in a WADL file</td>
                    <td>Specified method, specified resources, or
                        entire WADL file</td>
                    <td>Section or chapter</td>

                    <td><xref linkend="rollup_tables"/></td>
                </tr>


                <tr>
                    <th>API reference section</th>
                    <td>A single-method rollup table appears along
                        with detailed API reference information.</td>
                    <td>Specified method in a specified resource</td>
                    <td>A method</td>
                    <td>Section </td>
                    <td><xref linkend="reference_section_method"
                        /></td>
                </tr>
                <tr>
                    <th>API reference page</th>
                    <td/>
                    <td>All methods in one or more WADL files</td>
                    <td>One or more WADL files</td>
                    <td>Chapter definitions in a book file</td>
                    <td><xref linkend="api_ref_wadls"/></td>


                </tr>
            </tbody>
        </table>-->
        <section xml:id="api-ref-section-or-chapter">
            <title>API Reference Section or Chapter</title>
            <para>When you point to a WADL file or WADL elements from
                a DocBook file, the elements are transformed into
                various API reference outputs. </para>
            <para>You can point to WADL files or WADL elements from a
                DocBook file, as follows:<informaltable frame="void">
                    <col width="50%"/>
                    <col width="50%"/>
                    <thead>
                        <tr>
                            <th>Point to</th>
                            <th>Generates API reference outputs
                                for</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>A resource and one or more of its
                                child methods</td>
                            <td>The specified methods</td>
                        </tr>
                        <tr>
                            <td>A specified resource</td>
                            <td>All child methods</td>
                        </tr>
                        <tr>
                            <td>Entire WADL file</td>
                            <td>All resources and their child
                                methods</td>
                        </tr>
                    </tbody>
                </informaltable></para>
            <para>In each case, the structure in the generated API
                reference output reflects the structure of the
                resources and methods in the WADL file. </para>
            <para>The following API reference outputs are generated:<itemizedlist>
                    <listitem>
                        <para>A comprehensive roll-up table. Appears
                            at the top of the chapter or section where
                            you point to WADL elements or files. Lists
                            the HTTP method, URI, and description for
                            all referenced methods.</para>
                    </listitem>
                    <listitem>
                        <para>A section for each referenced resource.
                            The section contains a roll-up table of
                            all referenced methods in the
                            resource.</para>
                    </listitem>
                    <listitem>
                        <para>A sub-section for each referenced method
                            in each referenced resource. The
                            sub-section starts with a roll-up table
                            for the method, followed by a detail
                            description of the API method.</para>
                    </listitem>
                </itemizedlist></para>
            <example xml:id="chapter_entire_wadl">
                <title>API Reference Chapter or Section Markup</title>
                <para>The simplest way to generate an API reference
                    chapter or section is to reference an entire WADL
                    file. This approach requires little effort, but it
                    limits your control over the organization of the
                    reference chapter or section. You can use this
                    method at the chapter or section level
                    only.</para>
                <!-- <title>To generate a roll-up table:</title>
                        <step>
                            <para>If you have included section rollup
                                tables in your API reference chapter,
                                simply include the
                                   <code>role="api_reference"</code>
                                attribute on the
                                   <code>&lt;chapter&gt;</code>
                                element, as follows:
                                <programlisting language="xml"><xi:include href="samples/chapter_rollup_req.xml" parse="text"/></programlisting></para>
                            <para>If you have <emphasis role="bold"
                                   >not</emphasis> included section
                                rollup tables in your API reference
                                chapter, include the
                                   <code>role="api_reference"</code>
                                attribute on the
                                   <code>&lt;chapter&gt;</code>
                                element AND add a pointer to the WADL
                                file, as follows:</procedure>-->
                <programlisting language="xml"><xi:include href="ch_wadl_examples.xml" parse="text"/></programlisting>
                <para>To control where <code>&lt;resource&gt;</code>'s
                    start to turn into sections in the resulting
                    output, add the <code>&lt;?rax
                        start-sections?></code> directive to your
                    WADL:<programlisting language="xml"><xi:include href="samples/start_sections.xml" parse="text"/></programlisting></para>
            </example>
            <simplesect>
                <title>Markup for Specified Methods</title>
                <para>To have more fine-grained control of what
                    resources appear in the final document, you can
                    use markup like the following in your DocBook
                    document to pull in all the methods in some
                    resources. With this technique you can group the
                    resources together in arbitrary
                    combinations:</para>
                <programlisting language="xml"><xi:include href="samples/section_rollup_req.xml" parse="text"/></programlisting>
            </simplesect>
        </section>




        <section xml:id="reference_section_method">
            <title>Comprehensive Roll-up Table</title>
            <para/>
            <programlisting language="xml"><xi:include href="samples/summary_table_req.xml" parse="text"/></programlisting>
            <para/>
        </section>
        <section xml:id="api_ref_wadls">
            <title>API Reference Page</title>
            <para>The following example shows the markup for an API
                reference page and its resulting output.</para>
            <example xml:id="api_ref_markup">
                <title>API Reference Page Markup</title>
                <programlisting language="xml"><xi:include href="samples/api-ref-test.xml" parse="text"/></programlisting>
            </example>
            <example xml:id="api_ref_display">
                <title>API Reference Page Output</title>

                <figure>
                    <title>API reference page</title>
                    <mediaobject>
                        <imageobject>
                            <imagedata fileref="figures/api_ref.png"
                                contentwidth="6in"/>
                        </imageobject>
                    </mediaobject>
                </figure>
            </example>
            <para>To see the full page, go to <link
                    xlink:href="http://api.openstack.org/api-ref.html"
                    >OpenStack API Reference</link>. View the source
                to see the markup.</para>
        </section>
    </section>







</chapter>
